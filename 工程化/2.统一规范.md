# 统一规范

代码规范是指程序员在编码时要遵守的规则，规范的目的就是为了让程序员编写易于阅读、可维护的代码。

还有好处包括：

1. 规范的代码可以促进团队合作
2. 规范的代码可以降低维护成本
3. 规范的代码有助于 code review（代码审查）
4. 养成代码规范的习惯，有助于程序员自身的成长

当团队的成员都严格按照代码规范来写代码时，可以保证每个人的代码看起来都像是一个人写的，看别人的代码就像是在看自己的代码（代码一致性），阅读起来更加顺畅。更重要的是我们能够认识到规范的重要性，并坚持规范的开发习惯

## 代码规范

代码规范一般包含了代码格式规范、变量和函数命名规范、文档注释规范等等

### 代码格式

一般是指代码缩进使用空格还是 Tab、每行结尾要不要加分号、左花括号需不需要换行等等。

### 命名规范

命名规范一般指命名是使用驼峰式、匈牙利式还是帕斯卡式；用名词、名词组或动宾结构来命名。

```js
const smallObject = {} // 驼峰式，首字母小写
const SmallObject = {} // 帕斯卡式，首字母大写
const strName = 'strName' // 匈牙利式，前缀表示了变量是什么。这个前缀 str 表示了是一个字符串
```

变量命名和函数命名的侧重点不同

变量命名的重点是表明这个变量“是什么”，倾向于用名词命名。而函数命名的重点是表明这个函数“做什么”，倾向于用动宾结构来命名（动宾结构就是 doSomething）

```js
// 变量命名示例
const appleNum = 1
const sum = 10

// 函数命名示例
function formatDate() { ... }
function toArray() { ... }
```

> 由于拼音同音字太多，千万不要使用拼音来命名

### 注释规范

我们平时强调的代码规范、项目规范、重构等等，不就是为了减少沟通，提高开发效率吗。写注释的目的也是为了让代码更加容易理解，以后出问题了，也能快速定位问题，从而解决问题。

---

如果要让团队从头开始制订一份代码规范，工作量会非常大，也不现实。所以强烈建议找一份比较好的开源代码规范，在此基础上结合团队的需求作个性化修改。

> airbnb、百度前端规范 等等

### 如何检查代码规范

规范制订下来了，那怎么确保它被严格执行呢？目前有两个方法：

1. 使用工具校验代码格式

    - ESLint、Stylelint，使用 VSCode 自动格式化代码

2. 利用 code review 审查变量命名、注释

    - 代码审查是指让其他人来审查自己代码的一种行为

> 在找工作时，可以询问一下对方团队是否有测试规范、测试流程、代码审查等。如果同时拥有以上几点，说明是一个靠谱的团队，可以优先选择

## Git规范

Git 规范一般包括：Git Flow 规范、分支管理规范和 git commit 规范

### Git Flow 规范

![git-flow](/static/images/git-flow.png)

比如新版本开发时，先从主分支 master 拉出来一个开发分支 develop，然后团队成员再根据自己划分的模块，在 develop 的分支基础上建立自己的功能分支 feature/*

开发完成后，合并到 develop分支，提交测试，然后在自己的功能分支上修复bug，修复完成的bug再合入到 develop 分支，然后再提交测试，如此循环...

直到测试通过，把 develop 分支合并到主分支 master，然后打 tag

### 分支管理规范

分支命名以 feature/xx-xx fix/xx-xx 的格式命名，中间用短横线 - 连接

- master（线上环境）
- develop（开发环境）
- test（测试环境）
- feature/xxx（功能分支）
- fix/xxx（修复分支）

### Git Commit Message 规范

git 在每次提交时，都需要填写 commit message。

commit message 就是对你这次的代码提交进行一个简单的说明，好的提交说明可以让人一眼就明白这次代码提交做了什么。

```bash
<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>
```

commit message 分为三个部分(使用空行分割):

1. 标题行（subject）: 必填, 描述主要修改类型和内容。
2. 主题内容（body）: 描述为什么修改, 做了什么样的修改, 以及开发的思路等等。
3. 页脚注释（footer）: 可以写注释，放 BUG 号的链接

<https://www.conventionalcommits.org>

#### 验证 git commit 规范

利用 git hook 能在特定的重要动作发生时触发自定义脚本。

验证 git commit 规范也不例外，我们需要通过 git 的 pre-commit 钩子函数来进行。当然，你还需要下载一个辅助插件 husky 来帮助你进行验证。

比较常用的三个钩子的含义：

1. pre-commit，在 git commit 提交消息前执行，一般用来执行 lint，校验代码格式。
2. commit-msg，在 git commit 提交消息时执行，一般用来验证消息是否符合规范。
3. pre-push，在推送前执行，一般用于执行测试

通过工具，我们可以很好的管理团队成员的 git commit 格式，无需使用人力来检查，大大提高了开发效率。

使用 lint-staged 可以只对 git 暂存区上的文件进行校验，不需要对所有的文件进行 lint 检查。

## 项目规范

项目规范主要是指项目文件的组织方式和命名方式。

统一项目规范是为了方便管理与修改，不会出现同样性质的文件出现在不同的地方。例如同样是图片，一个出现在 assets 目录，一个出现在 img 目录。

创建目录，需要按照用途来划分。例如较常见的目录有：文档 doc、资源 src、测试 test...

```js
├─doc
├─src
├─test
```

src 资源目录又可以细分：

```js
├─api
├─asset
├─component
├─style
├─router
├─store
├─util
└─view
```

其实用哪种方式不重要，最重要的是**命名方式一定要统一**。

> 例如团队成员有人命名目录喜欢用复数形式（apis），有人喜欢用单数（api），这样是不允许的，一定要统一。

## UI 规范

注意，这里的 UI 规范是指项目里常用 UI 组件的表现方式以及组件的命名方式，而不是指 UI 组件如何设计

### 表现方式

现在开源的 UI 组件库有很多，不同的组件库的组件表现方式也不一样。例如有些按钮组件点击时颜色变深，有些组件则是变浅。所以建议在 PC 端和移动端都使用统一的 UI 组件库（PC 端、移动端各一个），或者同一个项目里只使用一个 UI 组件库。

另外，项目里常用的组件表现方式也需要通过文档确定下来。例如收缩展开的动画效果，具体到动画持续时间、动画是缓进快出还是快进缓出等等。

如果不把这些表现方式的规范确定下来，就有可能出现以下这种情况：

1. 同样的组件，在不同的页面有不同的表现方式（例如动画效果）。因为没有规范，开发根据个人喜好添加表现效果。
2. 同样的二次确认弹窗，提示语不一样，按钮类型也不一样

### 统一命名

1. 统一页面 UI 标准，节省 UI 设计时间。
2. 减少沟通成本，提高前端开发效率

## 总结

其实统一规范的最根本目的就是为了保证团队成员的一致性，从而减少沟通成本，提高开发效率。我以前就经历过因为规范不标准，造成产品与开发理解有偏差、开发各写各的代码，导致各种 BUG 不断，最后项目延期的事。

所以说为了提高开发效率，减少加班，请一定要统一规范。
