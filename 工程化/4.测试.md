# 测试

## 什么是测试

维基百科的定义：

在规定的条件下对程序进行操作，以发现程序错误，衡量软件质量，并对其是否能满足设计要求进行评估的过程

也可以这样理解：测试的作用是为了提高代码质量和可维护性。

1. 提高代码质量：测试就是找 BUG，找出 BUG，然后解决它。BUG 少了，代码质量自然就高了
2. 可维护性：对现有代码进行修改、新增功能从而造成的成本越低，可维护性就越高

## 什么时候写测试

- 如果你的程序非常简单，可以不用写测试
- 如果你的程序有数百行代码，但封装得很好，完美的践行了模块化的理念。每个模块功能单一、代码少，也可以不用写测试。

如果你的程序有成千上万行代码，数十个模块，模块与模块之间的交互错综复杂。在这种情况下，就需要写测试了。

## 测试类型与框架

测试类型有很多种：单元测试、集成测试、白盒测试...

测试框架也有很多种：Jest、Jasmine、LambdaTest...

本章将只讲解单元测试和 E2E 测试（end-to-end test 端到端测试）。其中单元测试使用的测试框架为 Jest，E2E 使用的测试框架为 Cypress。

## 单元测试

什么是单元测试？

单元测试（英语：Unit Testing）又称为模块测试，是针对程序模块（软件设计的最小单位）来进行正确性检验的测试工作

从前端角度来看，单元测试就是对一个函数、一个组件、一个类做的测试，它针对的粒度比较小。

单元测试应该怎么写呢？

1. 根据正确性写测试，即正确的输入应该有正常的结果。
2. 根据错误性写测试，即错误的输入应该是错误的结果。

- 对一个函数做测试
- 对一个类做测试
- 对一个组件做测试

### 测试覆盖率

什么是测试覆盖率？

用一个公式来表示：代码覆盖率 = 已执行的代码数 / 代码总数。

Jest 如果要开启测试覆盖率统计，只需要在 Jest 命令后面加上 --coverage 参数。

4 个统计项：

1. Stmts(statements)：语句覆盖率，程序中的每个语句是否都已执行。
2. Branch：分支覆盖率，是否执行了每个分支。
3. Funcs：函数覆盖率，是否执行了每个函数。
4. Lines：行覆盖率，是否执行了每一行代码

### TDD 测试驱动开发

TDD(Test-Driven Development) 就是根据需求提前把测试代码写好，然后根据测试代码实现功能。

## E2E 测试

端到端测试，主要是模拟用户对页面进行一系列操作并验证其是否符合预期。

Cypress 在进行 E2E 测试时，会打开 Chrome 浏览器，然后根据测试代码对页面进行操作，就像一个正常的用户在操作页面一样。
